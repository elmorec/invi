!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Invi={})}(this,function(t){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t){var e={}.toString.call(t).split(" ")[1].slice(0,-1).toLowerCase();return e.match(/element$/)?"element":e}var e=(o.prototype.on=function(t,e){(this._events[t]||(this._events[t]=[])).push(e)},o.prototype.off=function(t,e){this._events[t]&&this._events[t].splice(this._events[t].indexOf(e)>>>0,1)},o.prototype.removeAllListeners=function(){this._events={}},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(this._events[t]||[]).slice().map(function(t){t.apply(void 0,e)})},o);function o(){this._events={}}function i(t,n,o){function e(t){var e=function(t,e,n){void 0===n&&(n=document.body);for(var o,i=[],s=function(t,e){return[].map.call(t,e)}(n.querySelectorAll(e),function(t){return t});t&&!~s.indexOf(t);)t=t!==n&&!(null!=(o=t)&&o.nodeType==o.DOCUMENT_NODE)&&t.parentNode;return t&&i.indexOf(t)<0&&i.push(t),i}(t.target,n,i)[0];e&&o(e,t)}var i=this;return i.addEventListener(t,e),function(){i.removeEventListener(t,e)}}function s(t,e,n,o){void 0===o&&(o={passive:!0});var i=function(){n(),t.removeEventListener(e,i,o)};t.addEventListener(e,i,o)}var r,a,f=function(){var t={animation:"animationend",webkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oanimationend"};for(var e in t)if(e in document.body.style)return t[e]}();(a=r=r||{})[a.OPENED=0]="OPENED",a[a.CLOSED=1]="CLOSED",a[a.OPENING=2]="OPENING",a[a.CLOSING=3]="CLOSING";var h,d,u,p="open",v="close",m="cancel",y="confirm",E={host:document.body,title:"",content:"",animation:!0,event:"click",autoclose:!0,actions:[]},O=(n(h=b,d=u=e),void(h.prototype=null===d?Object.create(d):(g.prototype=d.prototype,new g)),b.config=function(t,e){var n=function t(e,n){var o=c({},e);if("object"!==l(n))return o;for(var i in n){var s=e[i],r=n[i],a=l(s);null!=s?a===l(r)&&(o[i]="object"===a?t(s,r):r):o[i]=r}return o}(E,t);if(f||(n.animation=!1),e)return n;E=n},b.prototype.render=function(){var n,o=this,i=this.config,t=i.classes||{},e=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),a=document.createElement("article");if(t.host&&(e.className=t.host),t.backdrop&&(s.className=t.backdrop),t.body&&(r.className=t.body),i.title){var c=document.createElement("header");c.innerHTML=i.title,r.appendChild(c),this.el.header=c}i.autoclose&&(s.dataset.action=v),a.innerHTML=i.content,i.actions&&i.actions.length&&(n=document.createElement("footer"),i.actions.forEach(function(t){var e=document.createElement("a");e.innerHTML=t.label,t.class&&(e.className=t.class),t.type&&(e.dataset.action=t.type),t.href&&(e.href=t.href),t.target&&(e.target=t.target),t.callback&&e.addEventListener(i.event,t.callback.bind(o)),n.appendChild(e)})),r.appendChild(a),n&&(r.appendChild(n),this.el.footer=n),e.appendChild(s),e.appendChild(r),this.host=e,this.el.body=r,this.el.content=a},b.prototype.setOverflow=function(t){this.config.host.style.overflow=t?"hidden":""},b.prototype.open=function(){var e=this;return this.state===r.OPENING||this.state===r.OPENED?Promise.reject():(this.setOverflow(!0),this.config.classes.enter&&this.config.animation?new Promise(function(t){e.host.classList.add(e.config.classes.enter),s(e.host,f,function(){e.host.classList.remove(e.config.classes.enter),e.state=r.OPENED,e.emit(p),t(e)}),e.state=r.OPENING,e.config.host.appendChild(e.host)}):(this.config.host.appendChild(this.host),this.state=r.OPENED,this.emit(p),Promise.resolve()))},b.prototype.close=function(){var e=this;return this.state===r.CLOSING||this.state===r.CLOSED?Promise.reject():(this.setOverflow(),this.config.classes.leave&&this.config.animation?new Promise(function(t){s(e.host,f,function(){e.config.host.removeChild(e.host),e.host.classList.remove(e.config.classes.leave),e.state=r.CLOSED,e.emit(v),t(e)}),e.state=r.CLOSING,e.host.classList.add(e.config.classes.leave)}):(this.config.host.removeChild(this.host),this.state=r.CLOSED,this.emit(v),Promise.resolve()))},b.prototype.destroy=function(){this.removeAllListeners(),this.host=this.el=this.config=null},b);function g(){this.constructor=h}function b(t){var e=u.call(this)||this;return e.state=r.CLOSED,e.el={},e.config=b.config(t,!0),e.render(),i.bind(e.host)(e.config.event,"[data-action]",function(t){switch(t.dataset.action){case v:e.close();break;case m:e.emit(m),e.close();break;case y:e.emit(y),e.close()}}),e}t.Modal=O,Object.defineProperty(t,"__esModule",{value:!0})});
