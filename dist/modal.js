!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Invi={})}(this,function(t){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t){var e=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1).toLowerCase();return e.match(/element$/)?"element":e}var e=function(){function t(){this.events={}}return t.prototype.on=function(t,e){(this.events[t]||(this.events[t]=[])).push(e)},t.prototype.off=function(t,e){this.events[t]&&this.events[t].splice(this.events[t].indexOf(e)>>>0,1)},t.prototype.removeAllListeners=function(){this.events={}},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(this.events[t]||[]).slice().map(function(t){t.apply(void 0,e)})},t}();function s(t,e,n){void 0===n&&(n=document.body);for(var o,i,s,r=[],a=(o=n.querySelectorAll(e),i=function(t){return t},Array.prototype.map.call(o,i));t&&!~a.indexOf(t);)t=t!==n&&!(null!=(s=t)&&s.nodeType==s.DOCUMENT_NODE)&&t.parentNode;return t&&r.indexOf(t)<0&&r.push(t),r}function r(t,e,n,o){void 0===o&&(o={passive:!0});var i=function(){n(),t.removeEventListener(e,i,o)};t.addEventListener(e,i,o)}var a,n,f=function(){var t={animation:"animationend",webkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oanimationend"};for(var e in t)if(e in document.body.style)return t[e]}();(n=a||(a={}))[n.OPENED=0]="OPENED",n[n.CLOSED=1]="CLOSED",n[n.OPENING=2]="OPENING",n[n.CLOSING=3]="CLOSING";var h="open",d="close",u="cancel",p="confirm",v={host:document.body,title:"",content:"",animation:!0,event:"click",autoclose:!0,actions:[]},o=function(n){function o(t){var e=n.call(this)||this;return e.state=a.CLOSED,e.el={},e.config=o.config(t,!0),e.render(),function(t,n,o){var i=this;i.addEventListener(t,function(t){var e=s(t.target,n,i)[0];e&&o(e,t)})}.bind(e.host)(e.config.event,"[data-action]",function(t){switch(t.dataset.action){case d:e.close();break;case u:e.emit(u),e.close();break;case p:e.emit(p),e.close()}}),e}return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(o,n),o.config=function(t,e){var n=function t(e,n){var o=c({},e);if("object"!==l(n))return o;for(var i in n){var s=e[i],r=n[i],a=l(s);null!=s?a===l(r)&&(o[i]="object"===a?t(s,r):r):o[i]=r}return o}(v,t);if(f||(n.animation=!1),e)return n;v=n},o.prototype.render=function(){var n,o=this,i=this.config,t=i.classes||{},e=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),a=document.createElement("article");if(t.host&&(e.className=t.host),t.backdrop&&(s.className=t.backdrop),t.body&&(r.className=t.body),i.title){var c=document.createElement("header");c.innerHTML=i.title,r.appendChild(c),this.el.header=c}i.autoclose&&(s.dataset.action=d),a.innerHTML=i.content,i.actions&&i.actions.length&&(n=document.createElement("footer"),i.actions.forEach(function(t){var e=document.createElement("a");e.innerHTML=t.label,t.class&&(e.className=t.class),t.type&&(e.dataset.action=t.type),t.redirect&&(e.href=t.redirect),t.target&&(e.target=t.target),t.callback&&e.addEventListener(i.event,t.callback.bind(o)),n.appendChild(e)})),r.appendChild(a),n&&(r.appendChild(n),this.el.footer=n),e.appendChild(s),e.appendChild(r),this.host=e,this.el.body=r,this.el.content=a},o.prototype.setOverflow=function(t){this.config.host.style.overflow=t?"hidden":""},o.prototype.open=function(){var e=this;return this.state===a.OPENING||this.state===a.OPENED?Promise.reject():(this.setOverflow(!0),this.config.classes.enter&&this.config.animation?new Promise(function(t){e.host.classList.add(e.config.classes.enter),r(e.host,f,function(){e.host.classList.remove(e.config.classes.enter),e.state=a.OPENED,e.emit(h),t(e)}),e.state=a.OPENING,e.config.host.appendChild(e.host)}):(this.config.host.appendChild(this.host),this.state=a.OPENED,this.emit(h),Promise.resolve()))},o.prototype.close=function(){var e=this;return this.state===a.CLOSING||this.state===a.CLOSED?Promise.reject():(this.setOverflow(),this.config.classes.leave&&this.config.animation?new Promise(function(t){r(e.host,f,function(){e.config.host.removeChild(e.host),e.host.classList.remove(e.config.classes.leave),e.state=a.CLOSED,e.emit(d),t(e)}),e.state=a.CLOSING,e.host.classList.add(e.config.classes.leave)}):(this.config.host.removeChild(this.host),this.state=a.CLOSED,this.emit(d),Promise.resolve()))},o.prototype.destroy=function(){this.removeAllListeners(),this.host=this.el=this.config=null},o}(e);t.Modal=o,Object.defineProperty(t,"__esModule",{value:!0})});
