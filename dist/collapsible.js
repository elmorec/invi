!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Invi={})}(this,function(t){"use strict";var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var a=function(){return(a=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t){var e=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1).toLowerCase();return e.match(/element$/)?"element":e}var e=function(){function t(){this.events={}}return t.prototype.on=function(t,e){(this.events[t]||(this.events[t]=[])).push(e)},t.prototype.off=function(t,e){this.events[t]&&this.events[t].splice(this.events[t].indexOf(e)>>>0,1)},t.prototype.removeAllListeners=function(){this.events={}},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(this.events[t]||[]).slice().map(function(t){t.apply(void 0,e)})},t}();function c(t,e,n){void 0===n&&(n=document.body);for(var o,i,s,c=[],r=(o=n.querySelectorAll(e),i=function(t){return t},Array.prototype.map.call(o,i));t&&!~r.indexOf(t);)t=t!==n&&!(null!=(s=t)&&s.nodeType==s.DOCUMENT_NODE)&&t.parentNode;return t&&c.indexOf(t)<0&&c.push(t),c}function r(t,e,n,o){void 0===o&&(o={passive:!0});var i=function(){n(),t.removeEventListener(e,i,o)};t.addEventListener(e,i,o)}var f=function(){var t={transition:"transitionend",webkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionEnd"};for(var e in t)if(e in document.body.style)return t[e]}(),u="expand",p="collapse",d={selectors:{title:"header",content:"article"},classes:{},event:"click",indexes:[-1],accordion:!1,animation:!0},n=function(o){function i(t,e){void 0===e&&(e={});var n=o.call(this)||this;return n.items=[],n.config=i.config(e,!0),n.host=t,n.refresh(!0),function(t,n,o){var i=this;i.addEventListener(t,function(t){var e=c(t.target,n,i)[0];e&&o(e,t)})}.bind(t)(n.config.event,n.config.selectors.title,function(t){n.toggle(n.items.map(function(t){return t.title}).indexOf(t))}),n}return function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(i,o),i.config=function(t,e){var n=function t(e,n){var o=a({},e);if("object"!==l(n))return o;for(var i in n){var s=e[i],c=n[i],r=l(s);null!=s?r===l(c)&&(o[i]="object"===r?t(s,c):c):o[i]=c}return o}(d,t);if(f||(n.animation=!1),e)return n;d=n},i.prototype.toggle=function(t){var e=this.items[t];return e?this[e.active?"collapse":"expand"](t):Promise.reject()},i.prototype.collapse=function(t,e){var n=this,o=this.items[t],i=this.config.classes;return o?!o.active||o.busy?Promise.resolve({title:o.title,content:o.content,index:t}):(o.active=!1,i.titleActive&&o.title.classList.remove(i.titleActive),i.contentActive&&o.content.classList.remove(i.contentActive),e?void(o.content.style.display="none"):(o.busy=!0,new Promise(function(t){n.config.animation?(o.content.style.maxHeight=o.contentHeight+"px",setTimeout(function(){o.content.style.maxHeight=o.content.style.paddingTop=o.content.style.paddingBottom="0"},24),r(o.content,f,function(){o.content.style.display="none",o.content.style.maxHeight=o.content.style.paddingTop=o.content.style.paddingBottom="",setTimeout(t,24)})):(o.content.style.display="none",t())}).then(function(){return o.busy=!1,n.emit(p,o.content,t),{title:o.title,content:o.content,index:t}}))):Promise.reject()},i.prototype.expand=function(n,t){var o=this,e=this.items[n],i=this.config.classes;return e?e.active||e.busy?Promise.resolve({title:e.title,content:e.content,index:n}):(e.active=!0,i.titleActive&&e.title.classList.add(i.titleActive),i.contentActive&&e.content.classList.add(i.contentActive),t?(e.content.style.display="",void(this.config.accordion&&this.items.forEach(function(t,e){return n!==e&&o.collapse(e,!0)}))):(e.busy=!0,Promise.all([new Promise(function(t){o.config.animation?(e.content.style.maxHeight=e.content.style.paddingTop=e.content.style.paddingBottom="0",e.content.style.display="",setTimeout(function(){e.content.style.maxHeight=e.contentHeight+"px",e.content.style.paddingTop=e.content.style.paddingBottom=""},24),r(e.content,f,function(){e.content.style.maxHeight=e.content.style.paddingTop=e.content.style.paddingBottom="",setTimeout(t,24)})):(e.content.style.display="",t())}).then(function(){e.busy=!1,o.emit(u,e.content,n)})].concat(this.config.accordion?this.items.map(function(t,e){return n!==e?o.collapse(e):void 0}):void 0)).then(function(){return{title:e.title,content:e.content,index:n}}))):Promise.reject()},i.prototype.refresh=function(t){var e,n,i=this,o=this.host.querySelectorAll(this.config.selectors.title),s=this.host.querySelectorAll(this.config.selectors.content),c=[];e=o,n=function(t,e){var n=s[e];if(n){var o={title:t,content:n,active:!0,busy:!1};i.config.animation&&(o.contentHeight=n.offsetHeight),c.push(o)}},Array.prototype.forEach.call(e,n),this.items=c,t&&c.map(function(t,e){return i[~i.config.indexes.indexOf(e)?"expand":"collapse"](e,!0)})},i.prototype.destroy=function(){this.removeAllListeners(),this.host=this.items=this.config=null},i}(e);t.Collapsible=n,Object.defineProperty(t,"__esModule",{value:!0})});
