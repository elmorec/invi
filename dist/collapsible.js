!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).Invi={})}(this,function(t){"use strict";var s=function(t,n){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};var a=function(){return(a=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function l(t){var n=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1).toLowerCase();return n.match(/element$/)?"element":n}var n=function(){function t(){this.events={}}return t.prototype.on=function(t,n){(this.events[t]||(this.events[t]=[])).push(n)},t.prototype.off=function(t,n){this.events[t]&&this.events[t].splice(this.events[t].indexOf(n)>>>0,1)},t.prototype.removeAllListeners=function(){this.events={}},t.prototype.emit=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];(this.events[t]||[]).slice().map(function(t){t.apply(void 0,n)})},t}();function c(t,n,e){void 0===e&&(e=document.body);for(var o,i,s,c=[],r=(o=e.querySelectorAll(n),i=function(t){return t},Array.prototype.map.call(o,i));t&&!~r.indexOf(t);)t=t!==e&&!(null!=(s=t)&&s.nodeType==s.DOCUMENT_NODE)&&t.parentNode;return t&&c.indexOf(t)<0&&c.push(t),c}function r(t,n,e,o){void 0===o&&(o={passive:!0});var i=function(){e(),t.removeEventListener(n,i,o)};t.addEventListener(n,i,o)}var f=function(){var t={transition:"transitionend",webkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionEnd"};for(var n in t)if(n in document.body.style)return t[n]}(),u="expand",p="collapse",d={selectors:{title:"header",content:"article"},classes:{},event:"click",indexes:[-1],accordion:!1,animation:!0},e=function(o){function i(t,n){void 0===n&&(n={});var e=o.call(this)||this;return e.items=[],e.config=i.config(n,!0),e.host=t,e.refresh(!0),function(t,e,o){var i=this;i.addEventListener(t,function(t){var n=c(t.target,e,i)[0];n&&o(n,t)})}.bind(t)(e.config.event,e.config.selectors.title,function(t){e.toggle(e.items.map(function(t){return t.title}).indexOf(t))}),e}return function(t,n){function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}(i,o),i.config=function(t,n){var e=function t(n,e){var o=a({},n);if("object"!==l(e))return o;for(var i in e){var s=n[i],c=e[i],r=l(s);null!=s?r===l(c)&&(o[i]="object"===r?t(s,c):c):o[i]=c}return o}(d,t);if(f||(e.animation=!1),n)return e;d=e},i.prototype.toggle=function(t){var n=this.items[t];return n?this[n.active?"collapse":"expand"](t):Promise.reject()},i.prototype.collapse=function(t,n){var e=this,o=this.items[t],i=this.config.classes;return o?!o.active||o.busy?Promise.resolve({title:o.title,content:o.content,index:t}):(o.active=!1,i.active&&[o.title,o.content].forEach(function(t){return t.classList.remove(i.active)}),n?void(o.content.style.display="none"):(o.busy=!0,new Promise(function(t){e.config.animation?(o.content.style.maxHeight=o.contentHeight+"px",setTimeout(function(){o.content.style.maxHeight=o.content.style.paddingTop=o.content.style.paddingBottom="0"},24),r(o.content,f,function(){o.content.style.display="none",o.content.style.maxHeight=o.content.style.paddingTop=o.content.style.paddingBottom="",setTimeout(t,24)})):(o.content.style.display="none",t())}).then(function(){return o.busy=!1,e.emit(p,o.content,t),{title:o.title,content:o.content,index:t}}))):Promise.reject()},i.prototype.expand=function(e,t){var o=this,n=this.items[e],i=this.config.classes;return n?n.active||n.busy?Promise.resolve({title:n.title,content:n.content,index:e}):(n.active=!0,i.active&&[n.title,n.content].forEach(function(t){return t.classList.add(i.active)}),t?(n.content.style.display="",void(this.config.accordion&&this.items.forEach(function(t,n){return e!==n&&o.collapse(n,!0)}))):(n.busy=!0,Promise.all([new Promise(function(t){o.config.animation?(n.content.style.maxHeight=n.content.style.paddingTop=n.content.style.paddingBottom="0",n.content.style.display="",setTimeout(function(){n.content.style.maxHeight=n.contentHeight+"px",n.content.style.paddingTop=n.content.style.paddingBottom=""},24),r(n.content,f,function(){n.content.style.maxHeight=n.content.style.paddingTop=n.content.style.paddingBottom="",setTimeout(t,24)})):(n.content.style.display="",t())}).then(function(){n.busy=!1,o.emit(u,n.content,e)})].concat(this.config.accordion?this.items.map(function(t,n){return e!==n?o.collapse(n):void 0}):void 0)).then(function(){return{title:n.title,content:n.content,index:e}}))):Promise.reject()},i.prototype.refresh=function(t){var n,e,i=this,o=this.host.querySelectorAll(this.config.selectors.title),s=this.host.querySelectorAll(this.config.selectors.content),c=[];n=o,e=function(t,n){var e=s[n];if(e){var o={title:t,content:e,active:!0,busy:!1};i.config.animation&&(o.contentHeight=e.offsetHeight),c.push(o)}},Array.prototype.forEach.call(n,e),this.items=c,t&&c.map(function(t,n){return i[~i.config.indexes.indexOf(n)?"expand":"collapse"](n,!0)})},i.prototype.destroy=function(){this.removeAllListeners(),this.host=this.items=this.config=null},i}(n);t.Collapsible=e,Object.defineProperty(t,"__esModule",{value:!0})});
