!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).Invi={})}(this,function(t){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};var c=function(){return(c=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function f(t){var n={}.toString.call(t).split(" ")[1].slice(0,-1).toLowerCase();return n.match(/element$/)?"element":n}function s(t){return t.charAt(0).toUpperCase()+t.substring(1)}function u(t){t.offsetHeight<0&&alert()}function d(n,t){var e={};return t.forEach(function(t){void 0!==n[t]&&(e[t]=n[t])}),e}var n=(i.prototype.on=function(t,n){(this._events[t]||(this._events[t]=[])).push(n)},i.prototype.off=function(t,n){this._events[t]&&this._events[t].splice(this._events[t].indexOf(n)>>>0,1)},i.prototype.removeAllListeners=function(){this._events={}},i.prototype.emit=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];(this._events[t]||[]).slice().map(function(t){t.apply(void 0,n)})},i);function i(){this._events={}}function o(t,e,i){function n(t){var n=function(t,n,e){void 0===e&&(e=document.body);for(var i,o=[],r=function(t,n){return[].map.call(t,n)}(e.querySelectorAll(n),function(t){return t});t&&!~r.indexOf(t);)t=t!==e&&!(null!=(i=t)&&i.nodeType==i.DOCUMENT_NODE)&&t.parentNode;return t&&o.indexOf(t)<0&&o.push(t),o}(t.target,e,o)[0];n&&i(n,t)}var o=this;return o.addEventListener(t,n),function(){o.removeEventListener(t,n)}}function l(t,n){for(var e in n)t.style[e]=n[e]}var p={};function h(t,n){if(t in document.body.style)return t;if(p[t])return p[t][n?1:0];for(var e,i=s(t),o=["webkit","Moz","O","ms"],r=0;r<o.length;r++){var a=o[r]+i;if(a in document.body.style)return p[t]=[a,(e=s(a),e.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()}))],p[t][n?1:0]}}var r,a,v,m=function(){var t={transition:"transitionend",webkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionEnd"};for(var n in t)if(n in document.body.style)return t[n]}(),y="expand",g="collapse",x={selectors:{title:"header",content:"article"},classes:{},event:"click",accordion:!1,animation:!0,duration:300},_=(e(r=A,a=v=n),void(r.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)),A.config=function(t,n){var e=function t(n,e){var i=c({},n);if("object"!==f(e))return i;for(var o in e){var r=n[o],a=e[o],s=f(r);null!=r?s===f(a)&&(i[o]="object"===s?t(r,a):a):i[o]=a}return i}(x,t);if(Array.isArray(e.index)||(e.index=[e.index]),e.index=e.index.filter(function(t){return"number"==typeof t}),m||(e.animation=!1),1<e.duration||(e.duration=x.duration),n)return e;x=e},A.prototype.toggle=function(t,n){var a=this,e=t=Array.isArray(t)?t:[t],i=this._items.filter(function(t,n){return~e.indexOf(n)&&!t.busy}),o=this._config.classes;if(i.length){if(this._config.animation&&!n)return new Promise(function(o){var r=i.length;i.forEach(function(n){var t,e=!n.expanded,i=n.contentHeight+"px";n.expanded=e,n.busy=!0,e?(l(n.content,{display:"",maxHeight:0,paddingTop:0,paddingBottom:0}),u(n.content),l(n.content,{maxHeight:i,paddingTop:"",paddingBottom:""})):(l(n.content,{maxHeight:i}),u(n.content),l(n.content,{maxHeight:0,paddingTop:0,paddingBottom:0})),l(n.content,((t={})[h("transitionDuration")]=a._config.duration+"ms",t[h("transitionProperty")]="max-height,padding-top,padding-bottom",t)),function(n,e,i){var o=function(t){t.propertyName===e&&(i(),n.removeEventListener(m,o))};n.addEventListener(m,o)}(n.content,"max-height",function(){var t;l(n.content,((t={maxHeight:"",paddingTop:"",paddingBottom:""})[h("transitionDuration")]="",t[h("transitionProperty")]="",t)),e||(n.content.style.display="none",u(n.content)),1===r?o():--r<1&&o(),n.busy=!1,a.emit(e?y:g,d(n,["content","title","index"]))})})});i.forEach(function(t){var n=!t.expanded;t.expanded=n,o.titleActive&&t.title.classList[n?"add":"remove"](o.titleActive),o.contentActive&&t.content.classList[n?"add":"remove"](o.contentActive),t.content.style.display=n?"":"none",u(t.content),a.emit(n?y:g,d(t,["content","title","index"]))})}},A.prototype.collapse=function(t,n){var e=Array.isArray(t)?t:[t];return this.toggle(this._items.filter(function(t,n){return~e.indexOf(n)&&t.expanded}).map(function(t){return t.index}),n)},A.prototype.expand=function(t,n){var e=Array.isArray(t)?t:[t];return this.toggle(this._items.filter(function(t,n){return~e.indexOf(n)&&!t.expanded}).map(function(t){return t.index}),n)},A.prototype.refresh=function(t){var o=this,n=this.host.querySelectorAll(this._config.selectors.title),r=this.host.querySelectorAll(this._config.selectors.content),a=[],e=t?this._config.index:this._items.filter(function(t){return t.expanded}).map(function(t){return t.index}),s=0;if(function(t,n){[].forEach.call(t,n)}(n,function(t,n){var e=r[n];if(e){var i={index:s++,title:t,content:e,expanded:!0,busy:!1};o._config.animation&&(i.contentHeight=e.offsetHeight),a.push(i)}}),this._items=a,t){var i=a.filter(function(t){return!~e.indexOf(t.index)}).map(function(t){return t.index});return this.toggle(i,!0)}},A.prototype.destroy=function(){this._removeDelegate(),this.removeAllListeners(),this.host=this._items=this._config=null},A);function b(){this.constructor=r}function A(t,n){var i=v.call(this)||this;return i.host=t,i._items=[],i._config=A.config(n||{},!0),i.refresh(!0),i._removeDelegate=o.bind(i.host)(i._config.event,i._config.selectors.title,function(t){var n=i._items.map(function(t){return t.title}).indexOf(t),e=i._items[n];e&&!e.busy&&(i._config.accordion&&i.collapse(i._items.filter(function(t){return t!==e}).map(function(t){return t.index})),i.toggle(n))}),i}t.Collapsible=_,Object.defineProperty(t,"__esModule",{value:!0})});
