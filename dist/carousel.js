!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Invi={})}(this,function(t){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};var a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function u(t){var e=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1).toLowerCase();return e.match(/element$/)?"element":e}function c(t){return t.charAt(0).toUpperCase()+t.substring(1)}var e=function(){function t(){this.events={}}return t.prototype.on=function(t,e){(this.events[t]||(this.events[t]=[])).push(e)},t.prototype.off=function(t,e){this.events[t]&&this.events[t].splice(this.events[t].indexOf(e)>>>0,1)},t.prototype.removeAllListeners=function(){this.events={}},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];(this.events[t]||[]).slice().map(function(t){t.apply(void 0,e)})},t}();function r(t,e){for(var i in e)t.style[i]=e[i]}var h={};function f(t,e){if(t in document.body.style)return t;if(h[t])return h[t][e?1:0];for(var i,n=c(t),s=["webkit","Moz","O","ms"],o=0;o<s.length;o++){var r=s[o]+n;if(r in document.body.style)return h[t]=[r,(i=c(r),i.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()}))],h[t][e?1:0]}}var l="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,p=function(){var t={transition:"transitionend",webkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionEnd"};for(var e in t)if(e in document.body.style)return t[e]}(),v=a({slide:"slide",slideChange:"slideChange"},l?{start:"touchstart",move:"touchmove",end:["touchend"]}:{start:"mousedown",move:"mousemove",end:["mouseup","mouseleave"]}),d={selectors:{item:"li"},delay:4e3,speed:500,continuous:!1,auto:!1,index:0,threshold:.4,resistance:.4,classes:{}},i=function(s){function o(t,e){void 0===e&&(e={});var i=s.call(this)||this;if(i.items=[],i.current=0,i.config=o.config(e,!0),i.host=t,i.config.selectors.indicator){var n=document.querySelectorAll(i.config.selectors.indicator);n&&(i.indicators=n)}return i.setup(),i.offEvents=i.setupEvents(),i.config.auto&&i.start(),i}return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(o,s),o.config=function(t,e){var i=function t(e,i){var n=a({},e);if("object"!==u(i))return n;for(var s in i){var o=e[s],r=i[s],c=u(o);null!=o?c===u(r)&&(n[s]="object"===c?t(o,r):r):n[s]=r}return n}(d,t);if(i.auto&&(i.continuous=!0),(i.threshold<0||1<i.threshold)&&(i.threshold=d.threshold),(i.resistance<0||1<i.resistance)&&(i.resistance=d.resistance),p||(i.speed=0),i.selectors.indicator&&i.classes.indicatorActive||(delete i.selectors.indicator,delete i.classes.indicatorActive),i.resistance=1-i.resistance,e)return i;d=i},o.prototype.setup=function(){var t,e,i=this.host.querySelector(this.config.selectors.item).parentElement,n=[],s=i.offsetWidth;t=i.children,e=function(t,e){r(t,{width:s+"px",cssFloat:"left"}),n.push({el:t,index:e})},Array.prototype.forEach.call(t,e),r(i,{overflow:"hidden",width:s*n.length+"px"}),this.container=i,this.items=n,this.size=n.length,this.step=s,this.move(this.config.index,0)},o.prototype.setupEvents=function(){var s=this,o={x:0,y:0},r={x:0,y:0},i=s.config.continuous&&2<s.size,n={map:{},handleEvent:function(t){if(!s.busy){var e=this[this.map[t.type]];e&&e(t)}},start:function(t){var e=l?t.touches[0]:t;o.x=e.pageX,o.y=e.pageY,s.config.auto&&s.stop.call(s),a.apply(void 0,[v.move].concat(v.end))},move:function(t){if(!(t.touches&&1<t.touches.length)){var e=l?t.touches[0]:t;if(r.x=e.pageX-o.x,r.y=e.pageY-o.y,Math.abs(r.x)>=Math.abs(r.y)){var i=s.step-1,n=r.x*s.config.resistance;i<n?n=i:n<-i&&(n=-i),s.translate(s.current*s.step-n,0)}}},end:function(){var t=s.step*s.config.threshold,e=Math.ceil(s.config.speed/s.step*Math.abs(r.x));u.apply(void 0,[v.move].concat(v.end)),r.x>t?i||0<s.current?s.prev().then(function(){s.config.auto&&s.start.call(s)}):s.translate(s.current*s.step,e):r.x<-t&&(i||s.current<s.size-1)?s.next().then(function(){s.config.auto&&s.start.call(s)}):s.translate(s.current*s.step,e)}},c={passive:!1},t=function(e){var t=v[e];"string"==typeof t?n.map[t]=e:t.forEach(function(t){return n.map[t]=e})};for(var e in v)t(e);return a(v.start),function(){u.apply(void 0,[v.start,v.move].concat(v.end))};function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){return s.container.addEventListener(t,n,c)})}function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){return s.container.removeEventListener(t,n,c)})}},o.prototype.translate=function(t,e){var i,n="translateX("+~~-t+"px)",s=e+"ms";r(this.container,((i={})[f("transform")]=n,i[f("transitionDuration")]=s,i))},o.prototype.move=function(i,t){var e=this;if(this.busy||i<0||i>this.size-1)return Promise.resolve(!1);var n,s=this.current===i&&0===i?0:this.items[this.current].index,o=this.config.continuous&&2<this.size,r=this.config.classes;this.busy=!0,r.active&&this.items[this.current].el.classList.remove(r.active),n=o?0===i?(this.items.unshift(this.items.pop()),1):i===this.size-1?(this.items.push(this.items.shift()),this.size-2):i:i;var c=this.items[n].index;return this.indicators&&(this.indicators[s]&&this.indicators[s].classList.remove(this.config.classes.indicatorActive),this.indicators[c]&&this.indicators[c].classList.add(this.config.classes.indicatorActive)),setTimeout(function(){e.emit(v.slide,s,c)},0),this.translate(i*this.step,t),0<t?new Promise(function(t){!function(t,e,i,n){void 0===n&&(n={passive:!0});var s=function(){i(),t.removeEventListener(e,s,n)};t.addEventListener(e,s,n)}(e.container,p,function(){a.call(e,function(){t(!0)})})}):a.call(this);function a(t){var e=this;r.active&&this.items[n].el.classList.add(r.active),o&&(0===i?(this.container.insertBefore(this.container.children[this.size-1],this.container.children[0]),this.translate(this.step,0)):i===this.size-1&&(this.container.appendChild(this.container.children[0]),this.translate(this.step*(i-1),0))),this.current=n,this.busy=!1,setTimeout(function(){e.emit(v.slideChange,e.items[n].index,s),t&&t()},0)}},o.prototype.slide=function(t){if(t<0||t>this.size-1||this.busy)return Promise.resolve(!1);for(var e=0;e<this.size;){if(this.items[e].index===t)return this.move(e,this.config.speed);e++}},o.prototype.next=function(){return this.move(this.size<3&&this.current===this.size-1?0:this.current+1,this.config.speed)},o.prototype.prev=function(){return this.move(this.size<3&&0===this.current?this.size-1:this.current-1,this.config.speed)},o.prototype.start=function(){var t=this;if(!(this.running||this.size<3)){this.stop(),this.running=!0;var e=function(){t.running&&(t.instance=setTimeout(function(){t.next().then(e)},t.config.delay))};e()}},o.prototype.stop=function(){clearInterval(this.instance),this.instance=null,this.running=!1},o.prototype.destroy=function(){this.offEvents(),this.removeAllListeners(),this.stop(),this.host=this.items=this.container=null},o}(e);t.Carousel=i,Object.defineProperty(t,"__esModule",{value:!0})});
